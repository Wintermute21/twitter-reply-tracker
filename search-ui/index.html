<html>
    <head>
        <meta charset='UTF-8' />

        <title>Twitter Reply Search UI</title>
        <script type='text/javascript' src='elm.js'>
        </script>
        <script type='text/javascript' src='lunr.js'>
        </script>
        <script type='text/javascript' src='saved-index.js'>
        </script>
        <script type='text/javascript' src='https://platform.twitter.com/widgets.js'>
        </script>
    </head>
    <body>
        <div id='elm'>
        </div>

        <script type='text/javascript'>
            var index = lunr.Index.load(savedIndexData);
            var app = Elm.Main.embed(document.getElementById('elm'));

            app.ports.performSearch.subscribe(function(query) {
                var results = index.search(query);
                app.ports.incomingSearchResults.send(results.map((match) => savedHtml[match.ref]));
            });

            app.ports.loadTweets.subscribe(function() {
                setTimeout(function() {
                    // XXX rate limit?
                    twttr.widgets.load();
                }, 500);
            });
        </script>
    </body>
</html>
